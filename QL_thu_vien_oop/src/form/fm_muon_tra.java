/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package form;
import controller.doc_gia_control;
import controller.phieu_muon_control;
import java.util.Date.*;
import java.util.*;
import javax.swing.JOptionPane;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import model.doc_gia;
import model.dong_phieu;
import model.phieu_muon;
import model.sach;
import model.dau_sach;
import controller.sach_control;
import controller.dau_sach_control;
import controller.dong_phieu_control;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.Calendar;
import dao.doc_gia_dao;
import dao.sach_dao;
import javax.swing.ImageIcon;

/**
 *
 * @author minh0
 */
public class fm_muon_tra extends javax.swing.JPanel {
    //thanh phan trong fm_lap_phieu
    protected static int stt;
    private List<sach> sachListtk;
    private List<doc_gia> dgListtk;
    private List<dong_phieu> dplapphieu;
    
    private List<dong_phieu> dptra;
    private List<dong_phieu> dpmuon;
    private List<phieu_muon> pmList;
    private List<phieu_muon> pmListtk;
    private phieu_muon pm;
    private doc_gia dg;
    private sach sach;
    private dau_sach daus;
    /**
     * Creates new form test5_4
     */
    public fm_muon_tra() {
        initComponents();
        intTP();
    }
    
    public void intTP(){
        stt = 0;
        phieu_muon_control.getpm_con().load_cb_tt(cb_tt_tk);
        Calendar cl = Calendar.getInstance();
        date_lap_phieu.setDate(cl.getTime());
        date_tra_phieu.setDate(cl.getTime());
        dateNgayMuon.setDate(cl.getTime());
        dateNgayTra.setDate(cl.getTime());
        date_ngay_tra_sach.setDate(cl.getTime());
        date_kt.setDate(cl.getTime());
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MM-yyyy");
        String datef = "01-01-2020";
        try {
            date_bd.setDate(dateFormat.parse(datef));
            // TODO add your handling code here:
        } catch (ParseException ex) {
            Logger.getLogger(fm_muon_tra.class.getName()).log(Level.SEVERE, null, ex);
        }
        Date ngaybd = date_bd.getDate();
        Date ngaykt = date_kt.getDate();
        pmListtk = phieu_muon_control.getpm_con().tim_pm("", "", "", ngaybd , ngaykt, bt_lap_phieu.isSelected());
        phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tk , pmListtk);
        dplapphieu = new ArrayList<>();
        
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        pop_tk_pm = new javax.swing.JPopupMenu();
        item_sua_pm = new javax.swing.JMenuItem();
        item_xoa_pm = new javax.swing.JMenuItem();
        item_tra_phieu = new javax.swing.JMenuItem();
        fm_tim_sach = new javax.swing.JDialog();
        txt_bienSach = new javax.swing.JTextField();
        bt_tkSach = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        tbl_dsSach = new javax.swing.JTable();
        jLabel23 = new javax.swing.JLabel();
        btSach_PM = new javax.swing.JButton();
        jLabel50 = new javax.swing.JLabel();
        txtMaPM = new javax.swing.JTextField();
        jLabel51 = new javax.swing.JLabel();
        txtCoc = new javax.swing.JFormattedTextField();
        jLabel52 = new javax.swing.JLabel();
        txtMuon = new javax.swing.JFormattedTextField();
        fm_lap_pm = new javax.swing.JDialog();
        txt_tk_doc_gia = new javax.swing.JTextField();
        bt_tk_dg = new javax.swing.JButton();
        jScrollPane7 = new javax.swing.JScrollPane();
        tbl_dg_tk = new javax.swing.JTable();
        jLabel39 = new javax.swing.JLabel();
        jScrollPane8 = new javax.swing.JScrollPane();
        tbl_sach_tk = new javax.swing.JTable();
        jPanel5 = new javax.swing.JPanel();
        jLabel40 = new javax.swing.JLabel();
        txt_ma_dg = new javax.swing.JTextField();
        jLabel41 = new javax.swing.JLabel();
        txt_tenDG = new javax.swing.JTextField();
        jLabel42 = new javax.swing.JLabel();
        txt_TTDG = new javax.swing.JTextField();
        jLabel43 = new javax.swing.JLabel();
        txt_maPM = new javax.swing.JTextField();
        jLabel44 = new javax.swing.JLabel();
        dateNgayMuon = new com.toedter.calendar.JDateChooser();
        jLabel45 = new javax.swing.JLabel();
        dateNgayTra = new com.toedter.calendar.JDateChooser();
        bt_lap_pm = new javax.swing.JButton();
        jScrollPane6 = new javax.swing.JScrollPane();
        tblSachPM = new javax.swing.JTable();
        jLabel46 = new javax.swing.JLabel();
        jLabel47 = new javax.swing.JLabel();
        jLabel48 = new javax.swing.JLabel();
        txtMaSach = new javax.swing.JTextField();
        btLuuSach = new javax.swing.JButton();
        txtTienCoc = new javax.swing.JFormattedTextField();
        txtGiaMuon = new javax.swing.JFormattedTextField();
        jLabel49 = new javax.swing.JLabel();
        txt_tk_sach = new javax.swing.JTextField();
        btThemSach = new javax.swing.JButton();
        btXoaSach = new javax.swing.JButton();
        bt_tk_sach = new javax.swing.JButton();
        pop = new javax.swing.JPopupMenu();
        menuHuyTT = new javax.swing.JMenuItem();
        menuTrahet = new javax.swing.JMenuItem();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        txt_ma_pm_ql = new javax.swing.JTextField();
        txt_ma_dg_pm = new javax.swing.JTextField();
        bt_them_pm = new javax.swing.JButton();
        bt_luu_pm = new javax.swing.JButton();
        bt_xoa_pm = new javax.swing.JButton();
        date_lap_phieu = new com.toedter.calendar.JDateChooser();
        date_tra_phieu = new com.toedter.calendar.JDateChooser();
        txt_ten_dg = new javax.swing.JTextField();
        txt_tt_dg = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        bt_tk_doc_gia = new javax.swing.JButton();
        jp_thong_tin_sach = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        txt_ma_sach = new javax.swing.JTextField();
        txt_ten_sach = new javax.swing.JTextField();
        txt_gia_sach = new javax.swing.JTextField();
        bt_them_sach = new javax.swing.JButton();
        bt_xoa_sach = new javax.swing.JButton();
        jLabel27 = new javax.swing.JLabel();
        txt_tt_sach = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        jLabel29 = new javax.swing.JLabel();
        bt_luu_sach = new javax.swing.JButton();
        txt_gia_muon = new javax.swing.JFormattedTextField();
        txt_tien_coc = new javax.swing.JFormattedTextField();
        bt_tim_sach = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbl_ds_sach = new javax.swing.JTable();
        jLabel12 = new javax.swing.JLabel();
        txt_tong_coc_m = new javax.swing.JFormattedTextField();
        jPanel2 = new javax.swing.JPanel();
        txt_tim_pm = new javax.swing.JTextField();
        bt_tk_pm_tra = new javax.swing.JButton();
        jLabel13 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tbl_pm_tra = new javax.swing.JTable();
        jPanel6 = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        txt_sach_tra = new javax.swing.JTextField();
        txt_ten_sach_tra = new javax.swing.JTextField();
        txt_gia_sach_tra = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        bt_tra_sach = new javax.swing.JButton();
        bt_mat_sach = new javax.swing.JButton();
        txt_ghi_chu = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        date_ngay_tra_sach = new com.toedter.calendar.JDateChooser();
        txt_tien_phat = new javax.swing.JFormattedTextField();
        jScrollPane3 = new javax.swing.JScrollPane();
        tbl_sach_tra = new javax.swing.JTable();
        jLabel30 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        bt_thanhtoan = new javax.swing.JButton();
        jLabel33 = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        txt_tong_coc_t = new javax.swing.JFormattedTextField();
        txt_tong_muon = new javax.swing.JFormattedTextField();
        txt_tong_muon_dd = new javax.swing.JFormattedTextField();
        txt_tong_phat = new javax.swing.JFormattedTextField();
        txt_tong_phat_dd = new javax.swing.JFormattedTextField();
        jPanel3 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        txt_ma_pm_tk = new javax.swing.JTextField();
        txt_ma_dg_tk = new javax.swing.JTextField();
        bt_lap_phieu = new javax.swing.JRadioButton();
        bt_tra_phieu = new javax.swing.JRadioButton();
        jLabel24 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        bt_tk_pm_n = new javax.swing.JButton();
        jLabel26 = new javax.swing.JLabel();
        cb_tt_tk = new javax.swing.JComboBox<>();
        bt_lm_moi = new javax.swing.JButton();
        date_bd = new com.toedter.calendar.JDateChooser();
        date_kt = new com.toedter.calendar.JDateChooser();
        jScrollPane5 = new javax.swing.JScrollPane();
        tbl_pm_tk = new javax.swing.JTable();

        item_sua_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/refresh.png"))); // NOI18N
        item_sua_pm.setText("Sửa phiếu");
        item_sua_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                item_sua_pmActionPerformed(evt);
            }
        });
        pop_tk_pm.add(item_sua_pm);

        item_xoa_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        item_xoa_pm.setText("Xóa phiếu");
        item_xoa_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                item_xoa_pmActionPerformed(evt);
            }
        });
        pop_tk_pm.add(item_xoa_pm);

        item_tra_phieu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        item_tra_phieu.setText("Trả phiếu");
        item_tra_phieu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                item_tra_phieuActionPerformed(evt);
            }
        });
        pop_tk_pm.add(item_tra_phieu);

        fm_tim_sach.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        fm_tim_sach.setTitle("TÌm kiếm sách");
        fm_tim_sach.setAlwaysOnTop(true);
        fm_tim_sach.setModalityType(java.awt.Dialog.ModalityType.APPLICATION_MODAL);
        fm_tim_sach.setResizable(false);

        txt_bienSach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_bienSachActionPerformed(evt);
            }
        });
        txt_bienSach.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_bienSachKeyReleased(evt);
            }
        });

        bt_tkSach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tkSach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tkSachActionPerformed(evt);
            }
        });

        jScrollPane4.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder(""), "DS sách", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tbl_dsSach.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã sách", "Tên sách", "Giá tiền sách", "Tình trạng"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_dsSach.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_dsSachMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(tbl_dsSach);

        jLabel23.setFont(new java.awt.Font("Segoe UI", 2, 10)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(204, 0, 0));
        jLabel23.setText("(Nhập mã sách hoặc tên sách hoặc mã đầu sách)");

        btSach_PM.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        btSach_PM.setText("Thêm sách");
        btSach_PM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSach_PMActionPerformed(evt);
            }
        });

        jLabel50.setText("Mã PM");

        txtMaPM.setEditable(false);

        jLabel51.setText("Tiền cọc");

        txtCoc.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txtCoc.setText("10000");

        jLabel52.setText("Giá mượn");

        txtMuon.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txtMuon.setText("1000");

        javax.swing.GroupLayout fm_tim_sachLayout = new javax.swing.GroupLayout(fm_tim_sach.getContentPane());
        fm_tim_sach.getContentPane().setLayout(fm_tim_sachLayout);
        fm_tim_sachLayout.setHorizontalGroup(
            fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(fm_tim_sachLayout.createSequentialGroup()
                .addGroup(fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(fm_tim_sachLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jScrollPane4))
                    .addGroup(fm_tim_sachLayout.createSequentialGroup()
                        .addGap(176, 176, 176)
                        .addGroup(fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 238, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(fm_tim_sachLayout.createSequentialGroup()
                                .addComponent(txt_bienSach, javax.swing.GroupLayout.PREFERRED_SIZE, 193, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(bt_tkSach, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, fm_tim_sachLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel50, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtMaPM, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel51, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtCoc, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel52)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtMuon, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 26, Short.MAX_VALUE)
                .addComponent(btSach_PM)
                .addGap(18, 18, 18))
        );
        fm_tim_sachLayout.setVerticalGroup(
            fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(fm_tim_sachLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txt_bienSach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_tkSach))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel23)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 240, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(fm_tim_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btSach_PM)
                    .addComponent(jLabel50)
                    .addComponent(txtMaPM, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel51)
                    .addComponent(txtCoc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel52)
                    .addComponent(txtMuon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(22, Short.MAX_VALUE))
        );

        fm_tim_sachLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_tkSach, txt_bienSach});

        fm_lap_pm.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        fm_lap_pm.setTitle("Lập phiếu mượn");
        fm_lap_pm.setAlwaysOnTop(true);
        fm_lap_pm.setIconImage(null);
        fm_lap_pm.setModalityType(java.awt.Dialog.ModalityType.APPLICATION_MODAL);
        fm_lap_pm.setResizable(false);
        fm_lap_pm.addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosed(java.awt.event.WindowEvent evt) {
                fm_lap_pmWindowClosed(evt);
            }
        });

        txt_tk_doc_gia.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_tk_doc_giaKeyReleased(evt);
            }
        });

        bt_tk_dg.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tk_dg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tk_dgActionPerformed(evt);
            }
        });

        jScrollPane7.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Danh sách độc giả", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tbl_dg_tk.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Mã độc giả", "Tên độc giả", "Số CCCD", "Trạng thái"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_dg_tk.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_dg_tkMouseClicked(evt);
            }
        });
        jScrollPane7.setViewportView(tbl_dg_tk);

        jLabel39.setFont(new java.awt.Font("Segoe UI", 2, 10)); // NOI18N
        jLabel39.setForeground(new java.awt.Color(255, 0, 0));
        jLabel39.setText(" (Nhập mã độc giả hoặc số CCCD)");

        jScrollPane8.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder(""), "DS sách", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tbl_sach_tk.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Mã sách", "Tên sách", "Giá tiền sách", "Tình trạng"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_sach_tk.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_sach_tkMouseClicked(evt);
            }
        });
        jScrollPane8.setViewportView(tbl_sach_tk);

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Thông tin phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        jLabel40.setText("Mã độc giả");

        txt_ma_dg.setEditable(false);

        jLabel41.setText("Tên độc giả");

        txt_tenDG.setEditable(false);

        jLabel42.setText("Trạng thái");

        txt_TTDG.setEditable(false);

        jLabel43.setText("Mã PM");

        txt_maPM.setEditable(false);

        jLabel44.setText("Ngày mượn");

        dateNgayMuon.setDateFormatString("dd/MM/yyyy");

        jLabel45.setText("Ngày trả");

        dateNgayTra.setDateFormatString("dd/MM/yyyy");

        bt_lap_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        bt_lap_pm.setText("Lập Phiếu Mượn");
        bt_lap_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_lap_pmActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel40, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel41, javax.swing.GroupLayout.DEFAULT_SIZE, 74, Short.MAX_VALUE)
                    .addComponent(jLabel42, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txt_TTDG, javax.swing.GroupLayout.DEFAULT_SIZE, 117, Short.MAX_VALUE)
                    .addComponent(txt_tenDG)
                    .addComponent(txt_ma_dg))
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel45, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel44, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 76, Short.MAX_VALUE)
                    .addComponent(jLabel43, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, Short.MAX_VALUE)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txt_maPM, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(dateNgayMuon, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(dateNgayTra, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(bt_lap_pm, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(129, 129, 129))
        );

        jPanel5Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {dateNgayMuon, dateNgayTra, txt_maPM});

        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel40)
                    .addComponent(txt_ma_dg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_maPM, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel43))
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel41)
                        .addComponent(txt_tenDG, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel44))
                    .addComponent(dateNgayMuon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel42)
                        .addComponent(txt_TTDG, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel45))
                    .addComponent(dateNgayTra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(bt_lap_pm)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel5Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {txt_TTDG, txt_maPM, txt_ma_dg, txt_tenDG});

        jPanel5Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {dateNgayMuon, dateNgayTra});

        jPanel5Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jLabel40, jLabel41, jLabel42, jLabel43, jLabel44, jLabel45});

        jScrollPane6.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder(""), "DS sách trong phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tblSachPM.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Mã sách", "Tên sách", "Tiền cọc", "Giá mượn"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblSachPM.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblSachPMMouseClicked(evt);
            }
        });
        jScrollPane6.setViewportView(tblSachPM);

        jLabel46.setText("Mã sách");

        jLabel47.setText("Tiền cọc");

        jLabel48.setText("Giá mượn");

        txtMaSach.setEditable(false);

        btLuuSach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        btLuuSach.setToolTipText("Lưu thông tin sách trong phiếu mượn");
        btLuuSach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btLuuSachActionPerformed(evt);
            }
        });

        txtTienCoc.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txtTienCoc.setText("10000");

        txtGiaMuon.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txtGiaMuon.setText("1000");

        jLabel49.setFont(new java.awt.Font("Segoe UI", 2, 10)); // NOI18N
        jLabel49.setForeground(new java.awt.Color(255, 0, 0));
        jLabel49.setText("(Nhập mã sách hoặc tên sách hoặc mã đầu sách)");

        txt_tk_sach.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_tk_sachKeyReleased(evt);
            }
        });

        btThemSach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        btThemSach.setToolTipText("Thêm sách vào phiếu mượn");
        btThemSach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btThemSachActionPerformed(evt);
            }
        });

        btXoaSach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        btXoaSach.setToolTipText("Xóa sách khỏi phiếu mượn");
        btXoaSach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btXoaSachActionPerformed(evt);
            }
        });

        bt_tk_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tk_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tk_sachActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout fm_lap_pmLayout = new javax.swing.GroupLayout(fm_lap_pm.getContentPane());
        fm_lap_pm.getContentPane().setLayout(fm_lap_pmLayout);
        fm_lap_pmLayout.setHorizontalGroup(
            fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(fm_lap_pmLayout.createSequentialGroup()
                .addGap(79, 79, 79)
                .addComponent(txt_tk_doc_gia, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(bt_tk_dg, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(txt_tk_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(bt_tk_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(224, 224, 224))
            .addGroup(fm_lap_pmLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane7, javax.swing.GroupLayout.DEFAULT_SIZE, 475, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane6)
                    .addGroup(fm_lap_pmLayout.createSequentialGroup()
                        .addComponent(jLabel46, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel47, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtTienCoc, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel48)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtGiaMuon, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btThemSach, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btLuuSach)
                        .addGap(12, 12, 12)
                        .addComponent(btXoaSach)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane8))
                .addContainerGap())
            .addGroup(fm_lap_pmLayout.createSequentialGroup()
                .addGap(62, 62, 62)
                .addComponent(jLabel39, javax.swing.GroupLayout.PREFERRED_SIZE, 170, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel49, javax.swing.GroupLayout.PREFERRED_SIZE, 238, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(213, 213, 213))
        );

        fm_lap_pmLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btLuuSach, btThemSach, btXoaSach});

        fm_lap_pmLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {txt_tk_doc_gia, txt_tk_sach});

        fm_lap_pmLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {bt_tk_dg, bt_tk_sach});

        fm_lap_pmLayout.setVerticalGroup(
            fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(fm_lap_pmLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txt_tk_doc_gia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_tk_dg)
                    .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txt_tk_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(bt_tk_sach)))
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(fm_lap_pmLayout.createSequentialGroup()
                        .addGap(7, 7, 7)
                        .addComponent(jLabel49))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, fm_lap_pmLayout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel39)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 267, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(fm_lap_pmLayout.createSequentialGroup()
                        .addComponent(jScrollPane8, javax.swing.GroupLayout.PREFERRED_SIZE, 240, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(12, 12, 12)
                        .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(btLuuSach)
                            .addComponent(btThemSach)
                            .addComponent(btXoaSach)
                            .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txtMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel47)
                                .addComponent(txtTienCoc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel48)
                                .addComponent(txtGiaMuon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel46)))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(fm_lap_pmLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(37, Short.MAX_VALUE))
        );

        fm_lap_pmLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {btLuuSach, btThemSach, btXoaSach});

        fm_lap_pmLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_tk_dg, bt_tk_sach, txt_tk_doc_gia, txt_tk_sach});

        menuHuyTT.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        menuHuyTT.setText("Hủy trạng thái");
        menuHuyTT.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuHuyTTActionPerformed(evt);
            }
        });
        pop.add(menuHuyTT);

        menuTrahet.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        menuTrahet.setText("Trả toàn bộ phiếu");
        menuTrahet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuTrahetActionPerformed(evt);
            }
        });
        pop.add(menuTrahet);

        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Thông tin phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 8))); // NOI18N

        jLabel2.setText("Mã phiếu mượn");

        jLabel3.setText("Mã độc giả");

        jLabel4.setText("Ngày lập phiếu");

        jLabel5.setText("Hạn trả phiếu");

        txt_ma_pm_ql.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_ma_pm_qlActionPerformed(evt);
            }
        });

        txt_ma_dg_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_ma_dg_pmActionPerformed(evt);
            }
        });

        bt_them_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        bt_them_pm.setText("Thêm phiếu mượn");
        bt_them_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_them_pmActionPerformed(evt);
            }
        });

        bt_luu_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        bt_luu_pm.setText("Lưu phiếu mượn");
        bt_luu_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_luu_pmActionPerformed(evt);
            }
        });

        bt_xoa_pm.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        bt_xoa_pm.setText("Xóa phiếu mượn");
        bt_xoa_pm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_xoa_pmActionPerformed(evt);
            }
        });

        date_lap_phieu.setDateFormatString("dd/MM/yyyy");

        date_tra_phieu.setDateFormatString("dd/MM/yyyy");

        txt_ten_dg.setEditable(false);

        txt_tt_dg.setEditable(false);

        jLabel11.setText("Tên độc giả");

        jLabel14.setText("Trạng thái");

        bt_tk_doc_gia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        bt_tk_doc_gia.setText("Thêm phiếu mượn");
        bt_tk_doc_gia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tk_doc_giaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3)
                    .addComponent(jLabel11)
                    .addComponent(jLabel14))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txt_tt_dg, javax.swing.GroupLayout.DEFAULT_SIZE, 237, Short.MAX_VALUE)
                    .addComponent(txt_ten_dg)
                    .addComponent(txt_ma_dg_pm))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bt_them_pm, javax.swing.GroupLayout.PREFERRED_SIZE, 0, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4)
                    .addComponent(jLabel2)
                    .addComponent(jLabel5))
                .addGap(41, 41, 41)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(date_tra_phieu, javax.swing.GroupLayout.DEFAULT_SIZE, 210, Short.MAX_VALUE)
                    .addComponent(date_lap_phieu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txt_ma_pm_ql))
                .addGap(130, 130, 130)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bt_tk_doc_gia, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_luu_pm, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_xoa_pm, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(47, 47, 47))
        );

        jPanel4Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {bt_luu_pm, bt_tk_doc_gia, bt_xoa_pm});

        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txt_ma_pm_ql, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txt_ma_dg_pm, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel3)
                                .addComponent(bt_them_pm))
                            .addComponent(bt_tk_doc_gia))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(bt_luu_pm)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(bt_xoa_pm))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(7, 7, 7)
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(date_lap_phieu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel4)
                                .addComponent(txt_ten_dg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel11)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(txt_tt_dg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel5)
                                .addComponent(jLabel14))
                            .addComponent(date_tra_phieu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))))
        );

        jPanel4Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_luu_pm, bt_them_pm, bt_tk_doc_gia, bt_xoa_pm});

        jp_thong_tin_sach.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Thông tin sách mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 2, 8))); // NOI18N
        jp_thong_tin_sach.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));

        jLabel7.setText("Mã sách");

        jLabel8.setText("Tên Sách");

        jLabel9.setText("Giá tiền sách");

        jLabel10.setText("Tiền đặt cọc");

        txt_ma_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_ma_sachActionPerformed(evt);
            }
        });

        txt_ten_sach.setEditable(false);

        txt_gia_sach.setEditable(false);
        txt_gia_sach.setText("0");

        bt_them_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        bt_them_sach.setText("Thêm vào DS");
        bt_them_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_them_sachActionPerformed(evt);
            }
        });

        bt_xoa_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        bt_xoa_sach.setText("Xóa khỏi DS");
        bt_xoa_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_xoa_sachActionPerformed(evt);
            }
        });

        jLabel27.setText("Trạng thái");

        txt_tt_sach.setEditable(false);

        jLabel6.setText("Giá cho mượn");

        jLabel19.setText("VNĐ/ngày");

        jLabel28.setText("VNĐ");

        jLabel29.setText("VNĐ");

        bt_luu_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        bt_luu_sach.setText("Lưu vào DS");
        bt_luu_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_luu_sachActionPerformed(evt);
            }
        });

        txt_gia_muon.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txt_gia_muon.setText("0");

        txt_tien_coc.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        txt_tien_coc.setText("0");

        bt_tim_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tim_sach.setToolTipText("Tìm kiếm sách");
        bt_tim_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tim_sachActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jp_thong_tin_sachLayout = new javax.swing.GroupLayout(jp_thong_tin_sach);
        jp_thong_tin_sach.setLayout(jp_thong_tin_sachLayout);
        jp_thong_tin_sachLayout.setHorizontalGroup(
            jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_thong_tin_sachLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel27)
                    .addComponent(jLabel8)
                    .addComponent(jLabel7))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jp_thong_tin_sachLayout.createSequentialGroup()
                        .addComponent(txt_ma_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 248, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bt_tim_sach))
                    .addComponent(txt_ten_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 248, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_tt_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 106, Short.MAX_VALUE)
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel9)
                    .addComponent(jLabel10)
                    .addComponent(jLabel6))
                .addGap(18, 18, 18)
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txt_gia_sach)
                    .addComponent(txt_gia_muon, javax.swing.GroupLayout.DEFAULT_SIZE, 158, Short.MAX_VALUE)
                    .addComponent(txt_tien_coc))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel19, javax.swing.GroupLayout.DEFAULT_SIZE, 154, Short.MAX_VALUE)
                    .addGroup(jp_thong_tin_sachLayout.createSequentialGroup()
                        .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel29)
                            .addComponent(jLabel28))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bt_xoa_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 119, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_them_sach)
                    .addComponent(bt_luu_sach, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(63, 63, 63))
        );

        jp_thong_tin_sachLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {txt_ma_sach, txt_ten_sach, txt_tt_sach});

        jp_thong_tin_sachLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jLabel10, jLabel6, jLabel9});

        jp_thong_tin_sachLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {bt_luu_sach, bt_them_sach, bt_xoa_sach});

        jp_thong_tin_sachLayout.setVerticalGroup(
            jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_thong_tin_sachLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel9)
                        .addComponent(txt_gia_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel29)
                        .addComponent(bt_xoa_sach))
                    .addGroup(jp_thong_tin_sachLayout.createSequentialGroup()
                        .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel7)
                            .addComponent(txt_ma_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(bt_tim_sach))
                        .addGap(18, 18, 18)
                        .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 18, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txt_ten_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8)
                            .addComponent(jLabel28)
                            .addComponent(bt_them_sach)
                            .addComponent(txt_tien_coc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jp_thong_tin_sachLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel6)
                            .addComponent(jLabel19)
                            .addComponent(txt_tt_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel27)
                            .addComponent(bt_luu_sach)
                            .addComponent(txt_gia_muon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap())
        );

        jp_thong_tin_sachLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_tim_sach, txt_gia_muon, txt_gia_sach, txt_ma_sach, txt_ten_sach, txt_tien_coc, txt_tt_sach});

        jp_thong_tin_sachLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_luu_sach, bt_them_sach, bt_xoa_sach});

        jScrollPane1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Danh sách sách có trong phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 2, 8))); // NOI18N

        tbl_ds_sach.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã Phiếu mượn", "Mã Sách", "Tên Sách", "Tiền cọc", "Giá cho mượn /ngày"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_ds_sach.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_ds_sachMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tbl_ds_sach);

        jLabel12.setText("Tổng tiền cọc:");

        txt_tong_coc_m.setEditable(false);
        txt_tong_coc_m.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));
        txt_tong_coc_m.setOpaque(false);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(1, 1, 1)
                                .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addComponent(jp_thong_tin_sach, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jScrollPane1))
                        .addContainerGap())
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txt_tong_coc_m, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(147, 147, 147))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jp_thong_tin_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txt_tong_coc_m, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel12))
                .addContainerGap(65, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Quản lý mượn", jPanel1);

        bt_tk_pm_tra.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tk_pm_tra.setText("Tìm kiếm");
        bt_tk_pm_tra.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tk_pm_traActionPerformed(evt);
            }
        });

        jLabel13.setFont(new java.awt.Font("Tahoma", 2, 11)); // NOI18N
        jLabel13.setForeground(new java.awt.Color(255, 51, 51));
        jLabel13.setText("(Nhập mã phiếu mượn hoặc mã độc giả)");

        jScrollPane2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Danh sách phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 2, 8))); // NOI18N

        tbl_pm_tra.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã phiếu mượn", "Mã độc giả", "Tên độc giả", "Ngày lập phiếu", "Hạn trả", "Trạng Thái"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_pm_tra.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_pm_traMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tbl_pm_tra);

        jLabel15.setText("Mã sách");

        jLabel16.setText("Tên Sách");

        jLabel17.setText("Ghi chú");

        jLabel18.setText("Giá tiền sách");

        txt_sach_tra.setEditable(false);
        txt_sach_tra.setDragEnabled(true);
        txt_sach_tra.setEnabled(false);

        txt_ten_sach_tra.setEditable(false);

        txt_gia_sach_tra.setEditable(false);

        jLabel20.setText("Tiền phạt");

        bt_tra_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/add.png"))); // NOI18N
        bt_tra_sach.setText("Trả sách");
        bt_tra_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tra_sachActionPerformed(evt);
            }
        });

        bt_mat_sach.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/delete.png"))); // NOI18N
        bt_mat_sach.setText("Mất sách");
        bt_mat_sach.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_mat_sachActionPerformed(evt);
            }
        });

        jLabel1.setText("Ngày trả sách");

        date_ngay_tra_sach.setDateFormatString("dd/MM/yyyy");

        txt_tien_phat.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel16)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txt_ten_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, 189, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel15)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txt_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, 217, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel18)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txt_gia_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(74, 74, 74)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jLabel20, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(jLabel17))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txt_ghi_chu)
                    .addComponent(date_ngay_tra_sach, javax.swing.GroupLayout.DEFAULT_SIZE, 189, Short.MAX_VALUE)
                    .addComponent(txt_tien_phat))
                .addGap(109, 109, 109)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bt_tra_sach)
                    .addComponent(bt_mat_sach))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {bt_mat_sach, bt_tra_sach});

        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jLabel15, jLabel16, jLabel18});

        jPanel6Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {txt_gia_sach_tra, txt_sach_tra, txt_ten_sach_tra});

        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(jLabel17)
                    .addComponent(txt_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_ghi_chu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_tra_sach))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel16)
                    .addComponent(txt_ten_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel20)
                    .addComponent(bt_mat_sach)
                    .addComponent(txt_tien_phat, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel18)
                        .addComponent(txt_gia_sach_tra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel1))
                    .addComponent(date_ngay_tra_sach, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel6Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {bt_mat_sach, bt_tra_sach});

        jPanel6Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jLabel15, jLabel16, jLabel18});

        jPanel6Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {txt_gia_sach_tra, txt_sach_tra, txt_ten_sach_tra});

        jScrollPane3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "DS sách có trong phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tbl_sach_tra.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Mã sách", "Tên sách", "Tiền cọc", "Giá cho mượn", "Ngày trả sách", "Tiền phạt", "Trạng thái"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_sach_tra.setComponentPopupMenu(pop);
        tbl_sach_tra.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_sach_traMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tbl_sach_tra);

        jLabel30.setText("Tổng tiền mượn");

        jLabel31.setText("Tổng tiền phạt");

        jLabel32.setText("Tổng tiền cọc đã đóng");

        bt_thanhtoan.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/save.png"))); // NOI18N
        bt_thanhtoan.setText("Thanh toán");
        bt_thanhtoan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_thanhtoanActionPerformed(evt);
            }
        });

        jLabel33.setText("Tổng tiền mượn đã đóng");

        jLabel34.setText("Tổng tiền phạt đã đóng");

        txt_tong_coc_t.setEditable(false);
        txt_tong_coc_t.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));

        txt_tong_muon.setEditable(false);
        txt_tong_muon.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));

        txt_tong_muon_dd.setEditable(false);
        txt_tong_muon_dd.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));

        txt_tong_phat.setEditable(false);
        txt_tong_phat.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));

        txt_tong_phat_dd.setEditable(false);
        txt_tong_phat_dd.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(java.text.NumberFormat.getIntegerInstance())));

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jScrollPane2)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(93, 93, 93)
                                .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txt_tim_pm, javax.swing.GroupLayout.PREFERRED_SIZE, 213, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(34, 34, 34)
                                .addComponent(bt_tk_pm_tra))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(jLabel32)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txt_tong_coc_t, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(28, 28, 28)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel33))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(txt_tong_muon, javax.swing.GroupLayout.DEFAULT_SIZE, 95, Short.MAX_VALUE)
                                    .addComponent(txt_tong_muon_dd))
                                .addGap(55, 55, 55)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 126, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel34))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(txt_tong_phat_dd, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addComponent(txt_tong_phat, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(39, 39, 39)
                                        .addComponent(bt_thanhtoan)))))
                        .addGap(0, 195, Short.MAX_VALUE))
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txt_tim_pm, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bt_tk_pm_tra)
                    .addComponent(jLabel13))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel30)
                    .addComponent(jLabel31)
                    .addComponent(jLabel32)
                    .addComponent(bt_thanhtoan)
                    .addComponent(txt_tong_coc_t, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_tong_muon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_tong_phat, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel33)
                    .addComponent(jLabel34)
                    .addComponent(txt_tong_muon_dd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_tong_phat_dd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(17, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Quản lý trả", jPanel2);

        jLabel21.setText("Mã phiếu mượn");

        jLabel22.setText("Mã độc giả");

        txt_ma_dg_tk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_ma_dg_tkActionPerformed(evt);
            }
        });

        buttonGroup1.add(bt_lap_phieu);
        bt_lap_phieu.setSelected(true);
        bt_lap_phieu.setText("Ngày lập phiếu");

        buttonGroup1.add(bt_tra_phieu);
        bt_tra_phieu.setText("Hạn trả phiếu");

        jLabel24.setText("Từ ngày");

        jLabel25.setText("Đến ngày");

        bt_tk_pm_n.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/xemdiem.png"))); // NOI18N
        bt_tk_pm_n.setText("Tìm kiếm");
        bt_tk_pm_n.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_tk_pm_nActionPerformed(evt);
            }
        });

        jLabel26.setText("Tình trạng phiếu");

        cb_tt_tk.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Còn hạn", "Quá hạn", "Đã trả hết", " " }));

        bt_lm_moi.setIcon(new javax.swing.ImageIcon(getClass().getResource("/form/refresh.png"))); // NOI18N
        bt_lm_moi.setText("Làm mới");
        bt_lm_moi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bt_lm_moiActionPerformed(evt);
            }
        });

        date_bd.setDateFormatString("dd/MM/yyyy");

        date_kt.setDateFormatString("dd/MM/yyyy");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addGap(0, 0, Short.MAX_VALUE)
                                .addComponent(bt_tk_pm_n, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel7Layout.createSequentialGroup()
                                        .addComponent(jLabel21)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(txt_ma_pm_tk, javax.swing.GroupLayout.DEFAULT_SIZE, 352, Short.MAX_VALUE))
                                    .addGroup(jPanel7Layout.createSequentialGroup()
                                        .addComponent(jLabel22)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(txt_ma_dg_tk)))
                                .addGap(0, 0, Short.MAX_VALUE)))
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addGap(49, 49, 49)
                                .addComponent(bt_lm_moi))
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addGap(14, 14, 14)
                                .addComponent(jLabel26)
                                .addGap(18, 18, 18)
                                .addComponent(cb_tt_tk, javax.swing.GroupLayout.PREFERRED_SIZE, 289, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(138, 138, 138))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(bt_lap_phieu)
                            .addComponent(bt_tra_phieu))
                        .addGap(131, 131, 131)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel24)
                            .addComponent(jLabel25))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(date_bd, javax.swing.GroupLayout.DEFAULT_SIZE, 298, Short.MAX_VALUE)
                            .addComponent(date_kt, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(426, 426, 426))))
        );

        jPanel7Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jLabel21, jLabel22, jLabel25, jLabel26});

        jPanel7Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {txt_ma_dg_tk, txt_ma_pm_tk});

        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txt_ma_dg_tk, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel22)
                    .addComponent(jLabel26)
                    .addComponent(cb_tt_tk, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel21)
                    .addComponent(txt_ma_pm_tk, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(date_bd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(bt_lap_phieu)
                        .addComponent(jLabel24)))
                .addGap(8, 8, 8)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bt_tra_phieu)
                    .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addComponent(jLabel25)
                        .addComponent(date_kt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bt_tk_pm_n)
                    .addComponent(bt_lm_moi))
                .addContainerGap(28, Short.MAX_VALUE))
        );

        jPanel7Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jLabel21, jLabel22});

        jPanel7Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {txt_ma_dg_tk, txt_ma_pm_tk});

        jScrollPane5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "DS phiếu mượn", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 2, 10))); // NOI18N

        tbl_pm_tk.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "Mã phiếu mượn", "Mã độc giả", "Tên độc giả", "Ngày lập phiếu", "Hạn trả phiếu", "Tình trạng phiếu"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_pm_tk.setComponentPopupMenu(pop_tk_pm);
        jScrollPane5.setViewportView(tbl_pm_tk);

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane5, javax.swing.GroupLayout.DEFAULT_SIZE, 1057, Short.MAX_VALUE)
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.DEFAULT_SIZE, 231, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Tìm kiếm Phiếu Mượn", jPanel3);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane1)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void bt_xoa_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_xoa_sachActionPerformed
        if(dong_phieu_control.get_dpcon().xoa_dp(pm.getMa_PM(), sach.getMa_sach())){
            JOptionPane.showMessageDialog(jPanel4, "Xóa thành công");
            dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
            dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
        }
        else{
            JOptionPane.showMessageDialog(jPanel4, "Không thể xóa");
        }
    }//GEN-LAST:event_bt_xoa_sachActionPerformed

    private void bt_xoa_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_xoa_pmActionPerformed
        String ma = txt_ma_pm_ql.getText();
        pm = phieu_muon_control.getpm_con().laypm(ma);
        int ck =JOptionPane.showConfirmDialog(jPanel4," Xóa phiếu mượn : "+pm.getMa_PM(),"Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
        if(ck==JOptionPane.YES_OPTION){
            boolean kt = phieu_muon_control.getpm_con().xoa(pm.getMa_PM());
            if(kt){
                JOptionPane.showMessageDialog(jPanel4, "Xóa thành công");
            }else{
                JOptionPane.showMessageDialog(jPanel4, "Không thể xóa");
            }
        }
        
// TODO add your handling code here:
    }//GEN-LAST:event_bt_xoa_pmActionPerformed

    private void bt_tk_pm_nActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tk_pm_nActionPerformed
        String madg = txt_ma_dg_tk.getText().replaceAll("\\s+"," ").trim();
        String mapm = txt_ma_pm_tk.getText().replaceAll("\\s+"," ").trim();
        String trangthai = (String)cb_tt_tk.getSelectedItem();
        Date ngaybd = date_bd.getDate();
        Date ngaykt = date_kt.getDate();
        pmListtk = phieu_muon_control.getpm_con().tim_pm(madg, mapm, trangthai, ngaybd , ngaykt, bt_lap_phieu.isSelected());
        phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tk , pmListtk);
// TODO add your handling code here:
    }//GEN-LAST:event_bt_tk_pm_nActionPerformed

    private void txt_ma_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_ma_sachActionPerformed
        String masach = txt_ma_sach.getText().replaceAll("\\s+"," ").trim();
        sach =sach_control.getsach_con().getsach(masach);
        if(sach==null){
            //JOptionPane.showMessageDialog(jPanel4, "Lỗi mã sách");
            txt_ten_sach.setText("");
            txt_tt_sach.setText("");
            txt_gia_sach.setText("0");
        }else{
            daus = dau_sach_control.getDauSachControl().getdausach(sach.getMa_dau_sach());
            txt_ten_sach.setText(daus.getTen_dau_sach());
            txt_tt_sach.setText(sach.getTinh_trang());
            txt_gia_sach.setText(String.valueOf(sach.getGiatiensach()));
        }
        
    }//GEN-LAST:event_txt_ma_sachActionPerformed

    private void tbl_pm_traMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_pm_traMouseClicked
        int index = tbl_pm_tra.getSelectedRow();
        pm = pmList.get(index);
        dptra = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
        dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
        load_gia_tien(pm.getMa_PM());
        // TODO add your handling code here:
    }//GEN-LAST:event_tbl_pm_traMouseClicked

    private void txt_ma_dg_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_ma_dg_pmActionPerformed
        String madg = txt_ma_dg_pm.getText().replaceAll("\\s+"," ").trim();
        dg = doc_gia_control.getdg_con().getdocgia(madg);
        if(dg==null){
            JOptionPane.showMessageDialog(jPanel4, "Lỗi mã độc giả");
            txt_ten_dg.setText("");
            txt_tt_dg.setText("");
        }else{
            txt_ten_dg.setText(dg.getTen_doc_gia());
            txt_tt_dg.setText(dg.getTrang_thai());
            
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_ma_dg_pmActionPerformed

    private void bt_luu_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_luu_pmActionPerformed
        String mapm= txt_ma_pm_ql.getText().replaceAll("\\s+"," ").trim();
        String madg = txt_ma_dg_pm.getText().replaceAll("\\s+"," ").trim();
        dg = doc_gia_control.getdg_con().getdocgia(madg);
        String madocgia = dg.getMa_doc_gia();
        Date ngaymuon = date_lap_phieu.getDate();
        Date ngaytra = date_tra_phieu.getDate();
        String trangthai= "";
        int kt = phieu_muon_control.getpm_con().luu(mapm, madocgia, ngaymuon, ngaytra, trangthai);
        if(kt==1){
            JOptionPane.showMessageDialog(jPanel4, "Thêm thành công");
        }else if(kt==2){
            JOptionPane.showMessageDialog(jPanel4, "Lỗi");
        }else if(kt==3){
            JOptionPane.showMessageDialog(jPanel4, "Lưu thành công");
            dpmuon = dong_phieu_control.get_dpcon().tim_dp(mapm);
            dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
        }else {
            JOptionPane.showMessageDialog(jPanel4, "Lỗi");
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_luu_pmActionPerformed

    private void bt_them_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_them_pmActionPerformed
        /*String mapm= txt_ma_pm_ql.getText().replaceAll("\\s+"," ").trim();
        String madg = txt_ma_dg_pm.getText().replaceAll("\\s+"," ").trim();
        dg = doc_gia_control.getdg_con().getdocgia(madg);
        
        //them dk ma doc gia
        String madocgia = dg.getMa_doc_gia();
        Date ngaymuon = date_lap_phieu.getDate();
        Date ngaytra = date_tra_phieu.getDate();
        String trangthai= "";
        int kt = phieu_muon_control.getpm_con().them(mapm, madocgia, ngaymuon, ngaytra, trangthai);
        if(kt==1){
            JOptionPane.showMessageDialog(jPanel4, "them thanh cong");
            dg = doc_gia_control.getdg_con().getdocgia(madocgia);
            pm = phieu_muon_control.getpm_con().laypm(mapm);
        }else if(kt==2){
            JOptionPane.showMessageDialog(jPanel4, "co loi ko the them");
        }else if(kt==3||txt_ma_pm_ql.getText().compareTo("")==0){
            txt_ma_dg_pm.setText("");
            txt_ma_pm_ql.setText("");
            txt_ten_dg.setText("");
            txt_tt_dg.setText("");
            dg = null;
            pm = null;
            dpmuon = null;
            dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
            jp_thong_tin_sach.setEnabled(false);
        }*/
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_them_pmActionPerformed

    private void bt_them_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_them_sachActionPerformed
        
        String masach = txt_ma_sach.getText();
        String mapm = txt_ma_pm_ql.getText();
        sach = sach_control.getsach_con().getsach(masach);
        float tiencoc =Float.parseFloat(txt_tien_coc.getText());
        float giamuon = Float.parseFloat(txt_gia_muon.getText());
        pm= phieu_muon_control.getpm_con().laypm(mapm);
        if(sach==null){
            JOptionPane.showMessageDialog(jPanel4, "Lỗi mã sách");
        }else{
            daus = dau_sach_control.getDauSachControl().getdausach(sach.getMa_dau_sach());
            txt_ten_sach.setText(daus.getTen_dau_sach());
            txt_tt_sach.setText(sach.getTinh_trang());
            txt_gia_sach.setText(String.valueOf(sach.getGiatiensach()));
            int kt = dong_phieu_control.get_dpcon().them(pm.getMa_PM(), sach.getMa_sach(), giamuon, tiencoc);
            if(kt==1){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi mã PM");
            }else if(kt==2){
                JOptionPane.showMessageDialog(jPanel4, "Thêm thành công");
                dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
                dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
                load_tien_coc(pm.getMa_PM());
            }else if(kt==3){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            }else{
                //JOptionPane.showMessageDialog(jPanel4, "dong phieu da ton tai");
                txt_ten_sach.setText("");
                txt_tt_sach.setText("");
                txt_gia_sach.setText("0");
                txt_tien_coc.setText("0");
                txt_gia_muon.setText("0");
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_them_sachActionPerformed

    private void bt_luu_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_luu_sachActionPerformed
        String masach = txt_ma_sach.getText();
        sach = sach_control.getsach_con().getsach(masach);
        float tiencoc =Float.parseFloat(txt_tien_coc.getText());
        float giamuon = Float.parseFloat(txt_gia_muon.getText());
        if(sach==null){
            JOptionPane.showMessageDialog(jPanel4, "Lỗi mã sách");
        }else{
            daus = dau_sach_control.getDauSachControl().getdausach(sach.getMa_dau_sach());
            txt_ten_sach.setText(daus.getTen_dau_sach());
            txt_tt_sach.setText(sach.getTinh_trang());
            txt_gia_sach.setText(String.valueOf(sach.getGiatiensach()));
            int kt = dong_phieu_control.get_dpcon().luu_muon(pm.getMa_PM(), sach.getMa_sach(), giamuon, tiencoc);
            if(kt==1){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
                
            }else if(kt==2){
                JOptionPane.showMessageDialog(jPanel4, "Thêm thành công");
                dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
                dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
                load_tien_coc(pm.getMa_PM());
            }else if(kt==3){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            }else if(kt==4){
                JOptionPane.showMessageDialog(jPanel4, "Lưu thành công");
                dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
                dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
                load_tien_coc(pm.getMa_PM());
            }else{
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_luu_sachActionPerformed

    private void bt_tk_pm_traActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tk_pm_traActionPerformed
        String bien = txt_tim_pm.getText().replaceAll("\\s+"," ").trim();
        pmList = phieu_muon_control.getpm_con().tim(bien);
        phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tra, pmList);
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_tk_pm_traActionPerformed

    private void txt_ma_pm_qlActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_ma_pm_qlActionPerformed
        String ma = txt_ma_pm_ql.getText();
        pm= phieu_muon_control.getpm_con().laypm(ma);
        if(pm==null){
            
        }else{
            dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
            txt_ma_dg_pm.setText(pm.getMa_doc_gia());
            date_lap_phieu.setDate(pm.getNgay_muon());
            date_tra_phieu.setDate(pm.getNgay_tra());
            dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
            dg = doc_gia_control.getdg_con().getdocgia(pm.getMa_doc_gia());
            txt_ten_dg.setText(dg.getTen_doc_gia());
            txt_tt_dg.setText(dg.getTrang_thai());
            load_tien_coc(ma);
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_ma_pm_qlActionPerformed

    private void tbl_sach_traMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_sach_traMouseClicked
        int index = tbl_sach_tra.getSelectedRow();
        if(index<0){
            
        }else{
            txt_sach_tra.setText(dptra.get(index).getMaSach());
            sach = sach_control.getsach_con().getsach(dptra.get(index).getMaSach());
            daus = dau_sach_control.getDauSachControl().getdausach(sach.getMa_dau_sach());
            txt_ten_sach_tra.setText(daus.getTen_dau_sach());
            txt_gia_sach_tra.setText(String.valueOf(sach.getGiatiensach()));
            txt_ghi_chu.setText(dptra.get(index).getGhichu());
            txt_tien_phat.setText(String.valueOf(dptra.get(index).getTienphat()));
            if(dptra.get(index).getNgaytra()==null){
                Calendar cl = Calendar.getInstance();
                date_ngay_tra_sach.setDate(cl.getTime());
            }else{
                date_ngay_tra_sach.setDate(dptra.get(index).getNgaytra());
            }
            
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_tbl_sach_traMouseClicked

    private void tbl_ds_sachMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_ds_sachMouseClicked
        int index = tbl_ds_sach.getSelectedRow();
        sach = sach_control.getsach_con().getsach(dpmuon.get(index).getMaSach());
        daus = dau_sach_control.getDauSachControl().getdausach(sach.getMa_dau_sach());
        txt_ma_sach.setText(sach.getMa_sach());
        txt_ten_sach.setText(daus.getTen_dau_sach());
        txt_tt_sach.setText(sach.getTinh_trang());
        txt_gia_sach.setText(String.valueOf(sach.getGiatiensach()));
        txt_gia_muon.setText(String.valueOf(dpmuon.get(index).getGiachomuon()));
        txt_tien_coc.setText(String.valueOf(dpmuon.get(index).getTiencoc()));
        // TODO add your handling code here:
    }//GEN-LAST:event_tbl_ds_sachMouseClicked

    private void bt_tra_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tra_sachActionPerformed
        int index = tbl_sach_tra.getSelectedRow();
        if(index==-1){
            
        }else{
            String tp = txt_tien_phat.getText();
        float tienphat = Float.valueOf(tp);
        String ghichu = txt_ghi_chu.getText();
        Date ngaytra = date_ngay_tra_sach.getDate();
        int datra = 1;
        
        String mapm= dptra.get(index).getMaPM();
        String masach=dptra.get(index).getMaSach();
        int kt = dong_phieu_control.get_dpcon().tra_sach(mapm, masach, tienphat, ngaytra, datra, ghichu);
        if(kt==1){
            //dong phieu ko ton tai
            JOptionPane.showMessageDialog(jPanel4, "Lỗi");
        }else if(kt==2){
            //luu thanh cong
            dptra = dong_phieu_control.get_dpcon().tim_dp(mapm);
            dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
            load_gia_tien(mapm);
        }else{
            JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            //luu ko thanh cong
        }
        }
        
// TODO add your handling code here:
    }//GEN-LAST:event_bt_tra_sachActionPerformed

    private void bt_lm_moiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_lm_moiActionPerformed
        txt_ma_dg_tk.setText("");
        txt_ma_pm_tk.setText("");
        cb_tt_tk.setSelectedItem("");
        Calendar cl =Calendar.getInstance();
        date_kt.setDate(cl.getTime());
        bt_lap_phieu.setSelected(true);
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MM-yyyy");
        String datef = "01-01-2020";
        try {
            date_bd.setDate(dateFormat.parse(datef));
            // TODO add your handling code here:
        } catch (ParseException ex) {
            Logger.getLogger(fm_muon_tra.class.getName()).log(Level.SEVERE, null, ex);
        }
        String madg = txt_ma_dg_tk.getText().replaceAll("\\s+"," ").trim();
        String mapm = txt_ma_pm_tk.getText().replaceAll("\\s+"," ").trim();
        String trangthai = (String)cb_tt_tk.getSelectedItem();
        Date ngaybd = date_bd.getDate();
        Date ngaykt = date_kt.getDate();
        pmListtk = phieu_muon_control.getpm_con().tim_pm(madg, mapm, trangthai, ngaybd , ngaykt, bt_lap_phieu.isSelected());
        phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tk , pmListtk);
    }//GEN-LAST:event_bt_lm_moiActionPerformed

    private void bt_mat_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_mat_sachActionPerformed
        int index = tbl_sach_tra.getSelectedRow();
        //thong bao ok cancel
        if(index<0){
            
        }else{
            int kt =JOptionPane.showConfirmDialog(jPanel6," Độc giả đã làm mất sách này ","Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            if(kt==JOptionPane.YES_OPTION){
            
                String mapm =dptra.get(index).getMaPM();
                String masach=dptra.get(index).getMaSach();
                Date ngaytra = date_ngay_tra_sach.getDate();
                String ghichu = txt_ghi_chu.getText();
                float phat = Float.parseFloat( txt_tien_phat.getText());
                dong_phieu_control.get_dpcon().matsach(mapm, masach, phat, ngaytra, 0, ghichu, 0);
                dptra = dong_phieu_control.get_dpcon().tim_dp(mapm);
                dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
                load_gia_tien(mapm);
            }else{
            
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_mat_sachActionPerformed

    private void bt_thanhtoanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_thanhtoanActionPerformed
        int index = tbl_ds_sach.getSelectedRow();
//thong bao ok cancel
        int kt =JOptionPane.showConfirmDialog(jPanel6," Thanh toán hóa đơn mượn sách ","Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
        
        if(kt==JOptionPane.YES_OPTION){
            String mapm =pm.getMa_PM();
            dong_phieu_control.get_dpcon().thanh_toan(dptra, 1);
            dptra = dong_phieu_control.get_dpcon().tim_dp(mapm);
            dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
            load_gia_tien(mapm);
            int index1 =  tbl_pm_tra.getSelectedRow();
            pmList.set(index1, phieu_muon_control.getpm_con().laypm(mapm));
            phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tra, pmList);
            tbl_pm_tra.setRowSelectionInterval(index1, index1);
        }else{
            
        }
        
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_thanhtoanActionPerformed

    private void bt_tim_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tim_sachActionPerformed
        fm_tim_sach.setSize(700, 400);
        fm_tim_sach.setLocationRelativeTo(jPanel4);
        txtMaPM.setText(txt_ma_pm_ql.getText());
        fm_tim_sach.setVisible(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_tim_sachActionPerformed

    private void bt_tk_doc_giaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tk_doc_giaActionPerformed
        
        fm_lap_pm.setSize(1200, 650);
        fm_lap_pm.setLocationRelativeTo(null);
        txt_maPM.setText(phieu_muon_control.getpm_con().taomaPM(stt));
        stt++;
        dplapphieu = null;
        fm_lap_pm.setVisible(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_tk_doc_giaActionPerformed

    private void item_sua_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_item_sua_pmActionPerformed
        int index = tbl_pm_tk.getSelectedRow();
        if(index==-1){
            
        }else{
            txt_ma_pm_ql.setText(pmListtk.get(index).getMa_PM());
            txt_ma_pm_qlActionPerformed(evt);
            jTabbedPane1.setSelectedComponent(jPanel1);
        }
// TODO add your handling code here:
    }//GEN-LAST:event_item_sua_pmActionPerformed

    private void item_xoa_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_item_xoa_pmActionPerformed
        int index = tbl_pm_tk.getSelectedRow();
        if(index==-1){
            
        }else{
            int ck =JOptionPane.showConfirmDialog(jScrollPane5," Xóa phiếu mượn : "+pmListtk.get(index).getMa_PM(),"Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            if(ck==JOptionPane.YES_OPTION){
                boolean kt = phieu_muon_control.getpm_con().xoa(pmListtk.get(index).getMa_PM());
                if(kt){
                    //JOptionPane.showMessageDialog(tbl_pm_tk, "Xóa thành công");
                    pmListtk.remove(index);
                    phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tk, pmListtk);
                }else{
                    JOptionPane.showMessageDialog(tbl_pm_tk, "Xóa không thành công");
                }
            }
        }
// TODO add your handling code here:
    }//GEN-LAST:event_item_xoa_pmActionPerformed

    private void item_tra_phieuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_item_tra_phieuActionPerformed
        int index = tbl_pm_tk.getSelectedRow();
        if(index==-1){
            
        }else{
            txt_tim_pm.setText(pmListtk.get(index).getMa_PM());
            bt_tk_pm_traActionPerformed(evt);
            tbl_pm_tra.setRowSelectionInterval(0, 0);
            int index1 = tbl_pm_tra.getSelectedRow();
            pm = pmList.get(index1);
            dptra = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
            dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
            load_gia_tien(pm.getMa_PM());
            jTabbedPane1.setSelectedComponent(jPanel2);
        }
// TODO add your handling code here:
    }//GEN-LAST:event_item_tra_phieuActionPerformed

    private void bt_tk_dgActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tk_dgActionPerformed
        String maDocGia = txt_tk_doc_gia.getText();
        dgListtk = doc_gia_dao.getdocgia_dao().timdgmn(maDocGia);
        doc_gia_control.getdg_con().load_list_tblmini(tbl_dg_tk, dgListtk);
// TODO add your handling code here:
    }//GEN-LAST:event_bt_tk_dgActionPerformed

    private void bt_tk_sachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tk_sachActionPerformed
        String bien = txt_tk_sach.getText();
        sachListtk = sach_dao.getsach_dao().timsachmn(bien);
        sach_control.getsach_con().load_tblsachmini(tbl_sach_tk, sachListtk);
// TODO add your handling code here:
    }//GEN-LAST:event_bt_tk_sachActionPerformed

    private void tbl_sach_tkMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_sach_tkMouseClicked
        int index = tbl_sach_tk.getSelectedRow();
        txtMaSach.setText(sachListtk.get(index).getMa_sach());
        
        if(evt.getClickCount()==2&&!evt.isConsumed()){
            if(sachListtk.get(index).getTinh_trang().compareTo("Có thể mượn")==0){
                String masach = txtMaSach.getText();
                String maPM = txt_maPM.getText();
                float tiencoc =Float.valueOf(txtTienCoc.getText());
                float giamuon =Float.valueOf(txtGiaMuon.getText());
                if(masach==null||masach.compareTo("")==0){
            
                }else{
                    if(dplapphieu==null){
                        dong_phieu dp = new dong_phieu(maPM, masach, tiencoc, 0, giamuon, null, 0, 0, null);
                        dplapphieu= new ArrayList<>();
                        dplapphieu.add(dp);
                        dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
                    }else{
                        boolean kt = false;
                        for(int i=0;i<dplapphieu.size();i++){
                            if(dplapphieu.get(i).getMaSach().compareTo(masach)==0){
                                kt=true;
                            }
                        }
                    if(kt){
                        JOptionPane.showMessageDialog(fm_lap_pm, "Sách đã có trong phiếu mượn");
                    }else{
                        dong_phieu dp = new dong_phieu(maPM, masach, tiencoc, 0, giamuon, null, 0, 0, null);
                        dplapphieu.add(dp);
                        dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
                    }
                }
            }
            }else{
                JOptionPane.showMessageDialog(fm_lap_pm, "Sách không thể mượn");
            }
            
        }
// TODO add your handling code here:
    }//GEN-LAST:event_tbl_sach_tkMouseClicked

    private void tbl_dg_tkMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_dg_tkMouseClicked
        int index = tbl_dg_tk.getSelectedRow();
        txt_ma_dg.setText(dgListtk.get(index).getMa_doc_gia());
        txt_tenDG.setText(dgListtk.get(index).getTen_doc_gia());
        txt_TTDG.setText(dgListtk.get(index).getTrang_thai());
        
// TODO add your handling code here:
    }//GEN-LAST:event_tbl_dg_tkMouseClicked

    private void btThemSachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btThemSachActionPerformed
        String masach = txtMaSach.getText();
        String maPM = txt_maPM.getText();
        float tiencoc =Float.valueOf(txtTienCoc.getText());
        float giamuon =Float.valueOf(txtGiaMuon.getText());
        if(masach==null||masach.compareTo("")==0){
            
        }else{
            if(sach_control.getsach_con().getsach(masach).getTinh_trang().compareTo("Có thể mượn")==0){
                if(dplapphieu==null){
                dong_phieu dp = new dong_phieu(maPM, masach, tiencoc, 0, giamuon, null, 0, 0, null);
                dplapphieu = new ArrayList<>();
                dplapphieu.add(dp);
                dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
                }else{
                    boolean kt = false;
                    for(int i=0;i<dplapphieu.size();i++){
                        if(dplapphieu.get(i).getMaSach().compareTo(masach)==0){
                            kt=true;
                        }
                    }
                    if(kt){
                        JOptionPane.showMessageDialog(fm_lap_pm, "Sách đã có trong phiếu mượn");
                    }else{
                        dong_phieu dp = new dong_phieu(maPM, masach, tiencoc, 0, giamuon, null, 0, 0, null);
                        dplapphieu.add(dp);
                        dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
                    }
                }
            
            }else{
                JOptionPane.showMessageDialog(fm_lap_pm, "Sách không thể mượn");
            }
        }
// TODO add your handling code here:
    }//GEN-LAST:event_btThemSachActionPerformed

    private void btLuuSachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btLuuSachActionPerformed
        int index = tblSachPM.getSelectedRow();
        if(index==-1){
            
        }else{
            if(txtMaSach.getText().compareTo(dplapphieu.get(index).getMaSach())==0){
                dong_phieu dp = new dong_phieu(txt_maPM.getText(), txtMaSach.getText(), Float.valueOf(txtTienCoc.getText()), 0, Float.valueOf(txtGiaMuon.getText()), null, 0, 0, null);
                dplapphieu.set(index, dp);
                dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
            }else{
                txtMaSach.setText(dplapphieu.get(index).getMaSach());
                txtGiaMuon.setText(String.valueOf(dplapphieu.get(index).getGiachomuon()));
                txtTienCoc.setText(String.valueOf(dplapphieu.get(index).getTiencoc()));
            }
            
        }
        
// TODO add your handling code here:
    }//GEN-LAST:event_btLuuSachActionPerformed

    private void btXoaSachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btXoaSachActionPerformed
        int index = tblSachPM.getSelectedRow();
        if(index==-1){
            
        }else{
            dplapphieu.remove(index);
            txtMaSach.setText("");
            dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
        }
// TODO add your handling code here:
    }//GEN-LAST:event_btXoaSachActionPerformed

    private void tblSachPMMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblSachPMMouseClicked
        int index = tblSachPM.getSelectedRow();
        txtMaSach.setText(dplapphieu.get(index).getMaSach());
        txtGiaMuon.setText(String.valueOf(dplapphieu.get(index).getGiachomuon()));
        txtTienCoc.setText(String.valueOf(dplapphieu.get(index).getTiencoc()));
        // TODO add your handling code here:
    }//GEN-LAST:event_tblSachPMMouseClicked

    private void bt_lap_pmActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_lap_pmActionPerformed
        if(txt_ma_dg.getText()==null||txt_ma_dg.getText().compareTo("")==0||dplapphieu==null||dplapphieu.isEmpty()){
            
        }else{
            pm= new phieu_muon(txt_maPM.getText(),txt_ma_dg.getText(), dateNgayMuon.getDate(), dateNgayTra.getDate(), "");
            int kt = dong_phieu_control.get_dpcon().lapphieumuon(pm, dplapphieu);
            if(kt==0){
                JOptionPane.showMessageDialog(fm_lap_pm, "Thêm phiếu mượn không thành công");
            }else{
                JOptionPane.showMessageDialog(fm_lap_pm, "Thêm phiếu mượn thành công " + kt);
                txt_ma_pm_ql.setText(pm.getMa_PM());
                txt_ma_pm_qlActionPerformed(evt);
                fm_lap_pm.dispose();
            }
        }

    }//GEN-LAST:event_bt_lap_pmActionPerformed

    private void fm_lap_pmWindowClosed(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_fm_lap_pmWindowClosed
        sachListtk = sach_dao.getsach_dao().timsachmn("");
        sach_control.getsach_con().load_tblsachmini(tbl_sach_tk, sachListtk);
        dgListtk = doc_gia_dao.getdocgia_dao().timdgmn("");
        doc_gia_control.getdg_con().load_list_tblmini(tbl_dg_tk, dgListtk);
        dplapphieu = null;
        dong_phieu_control.get_dpcon().load_list_tblmuonmni(tblSachPM, dplapphieu);
        txt_ma_dg.setText("");
        txt_tenDG.setText("");
        txt_TTDG.setText("");
        // TODO add your handling code here:
    }//GEN-LAST:event_fm_lap_pmWindowClosed

    private void bt_tkSachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bt_tkSachActionPerformed
        String bien = txt_bienSach.getText();
        sachListtk = sach_dao.getsach_dao().timsachmn(bien);
        sach_control.getsach_con().load_tblsachmini(tbl_dsSach, sachListtk);
        // TODO add your handling code here:
    }//GEN-LAST:event_bt_tkSachActionPerformed

    private void tbl_dsSachMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_dsSachMouseClicked
        int index = tbl_dsSach.getSelectedRow();
        String maPM  = txtMaPM.getText();
        float coc = Float.parseFloat(txtCoc.getText());
        float muon = Float.parseFloat(txtMuon.getText());
        if(evt.getClickCount()==2&&!evt.isConsumed()){
            if(maPM==null||maPM.compareTo("")==0){
                
            }else{
                int kt = dong_phieu_control.get_dpcon().them(maPM, sachListtk.get(index).getMa_sach(), muon, coc);
            if(kt==1){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi mã PM");
            }else if(kt==2){
                JOptionPane.showMessageDialog(fm_tim_sach, "Thêm thành công");
                dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
                dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
                load_tien_coc(pm.getMa_PM());
                model.sach s = sach_control.getsach_con().getsach(sachListtk.get(index).getMa_sach());
                sachListtk.set(index, s);
                sach_control.getsach_con().load_tblsachmini(tbl_dsSach, sachListtk);
                tbl_dsSach.setRowSelectionInterval(index, index);
            }else if(kt==3){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            }else{
                //JOptionPane.showMessageDialog(jPanel4, "dong phieu da ton tai");
                txt_ten_sach.setText("");
                txt_tt_sach.setText("");
                //txt_gia_sach.setText("0");
                //txt_tien_coc.setText("0");
                //txt_gia_muon.setText("0");
            }
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_tbl_dsSachMouseClicked

    private void btSach_PMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btSach_PMActionPerformed
        int index = tbl_dsSach.getSelectedRow();
        String maPM  = txtMaPM.getText();
        float coc = Float.parseFloat(txtCoc.getText());
        float muon = Float.parseFloat(txtMuon.getText());
        if(index == -1){
            
        }
        else{
            if(maPM==null||maPM.compareTo("")==0){
                
            }else{
                int kt = dong_phieu_control.get_dpcon().them(maPM, sachListtk.get(index).getMa_sach(), muon, coc);
            if(kt==1){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi mã PM");
            }else if(kt==2){
                JOptionPane.showMessageDialog(fm_tim_sach, "Thêm thành công");
                dpmuon = dong_phieu_control.get_dpcon().tim_dp(pm.getMa_PM());
                dong_phieu_control.get_dpcon().load_list_tblmuon(tbl_ds_sach, dpmuon);
                load_tien_coc(pm.getMa_PM());
                model.sach s = sach_control.getsach_con().getsach(sachListtk.get(index).getMa_sach());
                sachListtk.set(index, s);
                sach_control.getsach_con().load_tblsachmini(tbl_dsSach, sachListtk);
                tbl_dsSach.setRowSelectionInterval(index, index);
            }else if(kt==3){
                JOptionPane.showMessageDialog(jPanel4, "Lỗi");
            }else{
                //JOptionPane.showMessageDialog(jPanel4, "dong phieu da ton tai");
                //txt_ten_sach.setText("");
                //txt_tt_sach.setText("");
                //txt_gia_sach.setText("0");
                //txt_tien_coc.setText("0");
                //txt_gia_muon.setText("0");
            }
            }
        }
// TODO add your handling code here:
    }//GEN-LAST:event_btSach_PMActionPerformed

    private void txt_bienSachActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_bienSachActionPerformed
        String bien = txt_bienSach.getText();
        sachListtk = sach_dao.getsach_dao().timsachmn(bien);
        sach_control.getsach_con().load_tblsachmini(tbl_dsSach, sachListtk);
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_bienSachActionPerformed

    private void menuHuyTTActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuHuyTTActionPerformed
        int index = tbl_sach_tra.getSelectedRow();
        if(index==-1){
            
        }else{
            int kt =JOptionPane.showConfirmDialog(tbl_sach_tra," Độc giả chưa trả sách ","Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            if(kt==JOptionPane.YES_OPTION){
                if(dong_phieu_control.get_dpcon().huytt(dptra.get(index))){
                    dptra = dong_phieu_control.get_dpcon().tim_dp(dptra.get(index).getMaPM());
                    dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
                    load_gia_tien(dptra.get(index).getMaPM());
                    //
                    int index1 =  tbl_pm_tra.getSelectedRow();
                    pmList.set(index1, phieu_muon_control.getpm_con().laypm(dptra.get(index).getMaPM()));
                    phieu_muon_control.getpm_con().load_list_tbl(tbl_pm_tra, pmList);
                    tbl_pm_tra.setRowSelectionInterval(index1, index1);
                }
            }else{
                
            }
        }
// TODO add your handling code here:
    }//GEN-LAST:event_menuHuyTTActionPerformed

    private void menuTrahetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuTrahetActionPerformed
        Date ngaytra = dateNgayTra.getDate();
        SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy");
        String date = formatter.format(ngaytra);
        int kt =JOptionPane.showConfirmDialog(tbl_sach_tra," Trả toàn bộ phiếu vào ngày: "+date,"Xác nhận", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
        if(kt==JOptionPane.YES_OPTION){
            dong_phieu_control.get_dpcon().tratoanbo(dptra, date_ngay_tra_sach.getDate());
            dptra = dong_phieu_control.get_dpcon().tim_dp(dptra.get(0).getMaPM());
            dong_phieu_control.get_dpcon().load_list_tbltra(tbl_sach_tra, dptra);
            load_gia_tien(dptra.get(0).getMaPM());
        }
// TODO add your handling code here:
    }//GEN-LAST:event_menuTrahetActionPerformed

    private void txt_bienSachKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_bienSachKeyReleased
        String bien = txt_bienSach.getText();
        sachListtk = sach_dao.getsach_dao().timsachmn(bien);
        sach_control.getsach_con().load_tblsachmini(tbl_dsSach, sachListtk);
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_bienSachKeyReleased

    private void txt_tk_doc_giaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_tk_doc_giaKeyReleased
        String maDocGia = txt_tk_doc_gia.getText();
        dgListtk = doc_gia_dao.getdocgia_dao().timdgmn(maDocGia);
        doc_gia_control.getdg_con().load_list_tblmini(tbl_dg_tk, dgListtk);
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_tk_doc_giaKeyReleased

    private void txt_tk_sachKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_tk_sachKeyReleased
        String bien = txt_tk_sach.getText();
        sachListtk = sach_dao.getsach_dao().timsachmn(bien);
        sach_control.getsach_con().load_tblsachmini(tbl_sach_tk, sachListtk);
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_tk_sachKeyReleased

    private void txt_ma_dg_tkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_ma_dg_tkActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_ma_dg_tkActionPerformed
    
    private void load_tien_coc(String ma){
        float tongcoc = dong_phieu_control.get_dpcon().tongtien(ma, 1);
        txt_tong_coc_m.setText(String.valueOf(tongcoc));
    }
    private void load_enable_tra(boolean enb){
        txt_ghi_chu.setEnabled(enb);
        txt_tien_phat.setEnabled(enb);
        date_ngay_tra_sach.setEnabled(enb);
        bt_tra_sach.setEnabled(enb);
        bt_mat_sach.setEnabled(enb);
        bt_thanhtoan.setEnabled(enb);
    }
    private void load_enable_pm(boolean enb){
        txt_ma_sach.setEnabled(enb);
        txt_tien_coc.setEnabled(enb);
        txt_gia_muon.setEnabled(enb);
        bt_them_sach.setEnabled(enb);
        bt_luu_sach.setEnabled(enb);
        bt_xoa_sach.setEnabled(enb);
    }
    private void load_gia_tien(String mapm){
        float tongcoc = dong_phieu_control.get_dpcon().tongtien(mapm, 1);
        float tongmuon = dong_phieu_control.get_dpcon().tongtien(mapm, 2);
        float tongphat=dong_phieu_control.get_dpcon().tongtien(mapm, 3);
        float tongmuondd=dong_phieu_control.get_dpcon().tongtien(mapm, 4);
        float tongphatdd=dong_phieu_control.get_dpcon().tongtien(mapm, 5);
        
        txt_tong_coc_t.setText(String.valueOf(tongcoc));
        txt_tong_muon.setText(String.valueOf(tongmuon));
        txt_tong_phat.setText(String.valueOf(tongphat));
        txt_tong_phat_dd.setText(String.valueOf(tongphatdd));
        txt_tong_muon_dd.setText(String.valueOf(tongmuondd));
        
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btLuuSach;
    private javax.swing.JButton btSach_PM;
    private javax.swing.JButton btThemSach;
    private javax.swing.JButton btXoaSach;
    private javax.swing.JRadioButton bt_lap_phieu;
    private javax.swing.JButton bt_lap_pm;
    private javax.swing.JButton bt_lm_moi;
    private javax.swing.JButton bt_luu_pm;
    private javax.swing.JButton bt_luu_sach;
    private javax.swing.JButton bt_mat_sach;
    private javax.swing.JButton bt_thanhtoan;
    private javax.swing.JButton bt_them_pm;
    private javax.swing.JButton bt_them_sach;
    private javax.swing.JButton bt_tim_sach;
    private javax.swing.JButton bt_tkSach;
    private javax.swing.JButton bt_tk_dg;
    private javax.swing.JButton bt_tk_doc_gia;
    private javax.swing.JButton bt_tk_pm_n;
    private javax.swing.JButton bt_tk_pm_tra;
    private javax.swing.JButton bt_tk_sach;
    private javax.swing.JRadioButton bt_tra_phieu;
    private javax.swing.JButton bt_tra_sach;
    private javax.swing.JButton bt_xoa_pm;
    private javax.swing.JButton bt_xoa_sach;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox<String> cb_tt_tk;
    private com.toedter.calendar.JDateChooser dateNgayMuon;
    private com.toedter.calendar.JDateChooser dateNgayTra;
    private com.toedter.calendar.JDateChooser date_bd;
    private com.toedter.calendar.JDateChooser date_kt;
    private com.toedter.calendar.JDateChooser date_lap_phieu;
    private com.toedter.calendar.JDateChooser date_ngay_tra_sach;
    private com.toedter.calendar.JDateChooser date_tra_phieu;
    private javax.swing.JDialog fm_lap_pm;
    private javax.swing.JDialog fm_tim_sach;
    private javax.swing.JMenuItem item_sua_pm;
    private javax.swing.JMenuItem item_tra_phieu;
    private javax.swing.JMenuItem item_xoa_pm;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel42;
    private javax.swing.JLabel jLabel43;
    private javax.swing.JLabel jLabel44;
    private javax.swing.JLabel jLabel45;
    private javax.swing.JLabel jLabel46;
    private javax.swing.JLabel jLabel47;
    private javax.swing.JLabel jLabel48;
    private javax.swing.JLabel jLabel49;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel50;
    private javax.swing.JLabel jLabel51;
    private javax.swing.JLabel jLabel52;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JScrollPane jScrollPane8;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JPanel jp_thong_tin_sach;
    private javax.swing.JMenuItem menuHuyTT;
    private javax.swing.JMenuItem menuTrahet;
    private javax.swing.JPopupMenu pop;
    private javax.swing.JPopupMenu pop_tk_pm;
    private javax.swing.JTable tblSachPM;
    private javax.swing.JTable tbl_dg_tk;
    private javax.swing.JTable tbl_dsSach;
    private javax.swing.JTable tbl_ds_sach;
    private javax.swing.JTable tbl_pm_tk;
    private javax.swing.JTable tbl_pm_tra;
    private javax.swing.JTable tbl_sach_tk;
    private javax.swing.JTable tbl_sach_tra;
    private javax.swing.JFormattedTextField txtCoc;
    private javax.swing.JFormattedTextField txtGiaMuon;
    private javax.swing.JTextField txtMaPM;
    private javax.swing.JTextField txtMaSach;
    private javax.swing.JFormattedTextField txtMuon;
    private javax.swing.JFormattedTextField txtTienCoc;
    private javax.swing.JTextField txt_TTDG;
    private javax.swing.JTextField txt_bienSach;
    private javax.swing.JTextField txt_ghi_chu;
    private javax.swing.JFormattedTextField txt_gia_muon;
    private javax.swing.JTextField txt_gia_sach;
    private javax.swing.JTextField txt_gia_sach_tra;
    private javax.swing.JTextField txt_maPM;
    private javax.swing.JTextField txt_ma_dg;
    private javax.swing.JTextField txt_ma_dg_pm;
    private javax.swing.JTextField txt_ma_dg_tk;
    private javax.swing.JTextField txt_ma_pm_ql;
    private javax.swing.JTextField txt_ma_pm_tk;
    private javax.swing.JTextField txt_ma_sach;
    private javax.swing.JTextField txt_sach_tra;
    private javax.swing.JTextField txt_tenDG;
    private javax.swing.JTextField txt_ten_dg;
    private javax.swing.JTextField txt_ten_sach;
    private javax.swing.JTextField txt_ten_sach_tra;
    private javax.swing.JFormattedTextField txt_tien_coc;
    private javax.swing.JFormattedTextField txt_tien_phat;
    private javax.swing.JTextField txt_tim_pm;
    private javax.swing.JTextField txt_tk_doc_gia;
    private javax.swing.JTextField txt_tk_sach;
    private javax.swing.JFormattedTextField txt_tong_coc_m;
    private javax.swing.JFormattedTextField txt_tong_coc_t;
    private javax.swing.JFormattedTextField txt_tong_muon;
    private javax.swing.JFormattedTextField txt_tong_muon_dd;
    private javax.swing.JFormattedTextField txt_tong_phat;
    private javax.swing.JFormattedTextField txt_tong_phat_dd;
    private javax.swing.JTextField txt_tt_dg;
    private javax.swing.JTextField txt_tt_sach;
    // End of variables declaration//GEN-END:variables
}
